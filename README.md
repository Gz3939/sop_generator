# SOP生成系統

一個基於Streamlit的標準作業程序(SOP)生成系統，可以讓您輕鬆創建包含圖片和步驟說明的SOP文檔。

## 功能特色

- 📸 **圖片上傳**: 支援PNG、JPG、JPEG、GIF格式的圖片上傳
- 📝 **步驟管理**: 可以添加、預覽、刪除操作步驟
- 📋 **SOP資訊**: 設定標題、作者、日期、目的、適用範圍
- 📄 **Word生成**: 自動生成格式化的Word文檔
- 🔍 **即時預覽**: 實時預覽SOP內容
- 💾 **自動保存**: 智慧自動保存，防止意外丟失進度
- 🔄 **自動恢復**: 重新開啟時自動恢復上次工作狀態

## 安裝步驟

1. 確保您已安裝Python 3.7或更高版本

2. 安裝必要的套件:
```bash
pip install streamlit python-docx Pillow
```

## 使用方法

1. 在命令列中執行:
```bash
streamlit run sop_generator.py
```

2. 瀏覽器會自動開啟應用程式

3. 在側邊欄填寫SOP基本資訊

4. 上傳圖片並添加步驟說明

5. 預覽SOP內容

6. 點擊"生成Word文檔"下載完成的SOP

## 系統架構

- `sop_generator.py`: 主要應用程式
- `requirements.txt`: 套件依賴清單
- `README.md`: 說明文檔

## 輸出格式

生成的Word文檔包含:
- SOP標題
- 建立者和建立日期
- 目的和適用範圍
- 按步驟編號排序的操作步驟
- 每個步驟的圖片和說明

## 自動保存功能

系統具備智慧自動保存功能：
- **即時保存**: 修改任何內容時自動保存到本地
- **自動恢復**: 重新開啟系統時自動恢復上次進度
- **手動控制**: 可手動保存或清除保存數據
- **保存文件**: 
  - `autosave_data.pkl`: 步驟數據和圖片
  - `sop_config.json`: SOP基本資訊

## 注意事項

- 圖片會自動調整大小以適合Word文檔
- 步驟按編號排序顯示
- 支援中文字體和格式
- 所有數據本地保存，保護隱私安全

## 疑難排解

如果遇到套件安裝問題，請嘗試:
```bash
pip install --upgrade pip
pip install -r requirements.txt
```

## 技術支援

如有問題請檢查:
1. Python版本是否符合要求
2. 所有依賴套件是否正確安裝
3. 圖片格式是否支援
